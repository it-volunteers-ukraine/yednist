document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("js-open-feedback-form"),t=document.getElementById("js-close-feedback-form"),n=document.getElementById("js-feedback-form"),s=document.querySelector(".feedback-modal");function i(e,t){e>t?s.classList.add("horizontal"):s.classList.remove("horizontal")}if(e){e.addEventListener("click",(function(){const e=window.scrollY;document.documentElement.style.scrollBehavior="auto",n.classList.remove("is-hidden"),i(u,m),window.addEventListener("resize",o),t.addEventListener("click",d),n.addEventListener("mousedown",a),window.addEventListener("keydown",c),window.addEventListener("resize",o),document.documentElement.classList.add("modal__opened"),document.documentElement.style.top=`-${e}px`}));let m=window.innerHeight,u=parseInt(getComputedStyle(s).height);function o(){m=window.innerHeight,i(u,m)}function d(){n.classList.add("is-hidden"),t.removeEventListener("click",d),n.removeEventListener("mousedown",a),s.classList.remove("horizontal"),window.removeEventListener("resize",o);const e=parseInt(document.documentElement.style.top||"0");document.documentElement.classList.remove("modal__opened"),window.scrollTo(0,-e),document.documentElement.style.scrollBehavior="smooth"}function a(e){e.target===n&&d()}function c(e){"Escape"===e.key&&(e.preventDefault(),d(),window.removeEventListener("keydown",c))}}const l=document.querySelector(".feedback-select-js"),r=document.getElementById("case-js");if(l){const v=new Choices(l,{placeholderValue:"Виберіть програму...",searchEnabled:!1,allowHTML:!1,shouldSort:!1,position:"bottom",itemSelectText:""}),h=document.querySelector(".feedback-modal .choices__inner"),f=v.config.choices.length;v.passedElement.element.addEventListener("choice",(function(e){if(e.detail.choice.active?(h.classList.add("valid"),h.classList.remove("invalid")):(h.classList.remove("valid"),h.classList.add("invalid")),e.detail.choice.id===f){r.classList.add("shown");let e=window.innerHeight,t=parseInt(getComputedStyle(s).height);e=window.innerHeight,i(t,e)}else r.classList.remove("shown")}),!1)}e&&jQuery(document).ready((function(e){const t=e(".input-name")[0],n=e(".input-email")[0],o=e(".input-case")[0],d=e(".input-review")[0];function a(t){const n=t.target,s=n.value.trim();let i,o;switch(n.getAttribute("name")){case"title":i=/^[^\d]+$/,o=i.test(s);break;case"email":i=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,o=i.test(s);break;case"case":case"description":o=s.length>=1}if(o?(n.classList.add("valid"),n.classList.remove("invalid")):(n.classList.add("invalid"),n.classList.remove("valid")),n===d){const t=e(".textarea-box");!o||n.classList.contains("invalid")?t.addClass("invalid").removeClass("valid"):t.addClass("valid").removeClass("invalid")}}t.addEventListener("keyup",a),n.addEventListener("keyup",a),o.addEventListener("keyup",a),d.addEventListener("keyup",a),e("#new_post").submit((function(c){c.preventDefault();var l,r=e(this),m=e(".feedback-notification-js"),u=e(".close-notification-btn"),v=function(e){"Escape"===e.key&&(e.preventDefault(),f())},h=function(t){e(t.target).is(m)&&f()};function f(){const t=e("html").css("top");clearTimeout(l),m.addClass("is-hidden"),m.off("mousedown",h),e("html").removeClass("modal__opened"),window.scrollTo(0,-1*parseInt(t||"0")),e(window).off("keydown",v),e("html").css("scrollBehavior","smooth")}const w=[t,n,d];e(".feedback-case")[0].classList.contains("shown")&&w.push(o);let L=!0;w.forEach((t=>{if(a({target:t}),!t.value.trim()||t.classList.contains("invalid")){t.classList.add("invalid"),e(".feedback-alert").removeClass("hidden");let o=window.innerHeight,d=parseInt(getComputedStyle(s).height);function n(){o=window.innerHeight,i(d,o)}n(),e(window).resize(n),L=!1}}));const p=e(".feedback-modal .choices__inner")[0];e(".feedback-modal .choices__inner .choices__item")[0].classList.contains("choices__placeholder")&&(p.classList.add("invalid"),e(".feedback-alert").removeClass("hidden"),L=!1),L&&e.ajax({type:r.attr("method"),url:r.attr("action"),data:r.serialize(),success:function(t){t.success?(r.trigger("reset"),e(".feedback-alert").addClass("hidden"),e(".feedback-backdrop").addClass("is-hidden"),setTimeout((function(){e(".feedback-backdrop").addClass("is-hidden"),m.removeClass("is-hidden"),e(window).on("keydown",v),m.on("mousedown",h),l=setTimeout(f,5e3),u.on("click",f)}))):(e(".feedback-alert").removeClass("hidden"),console.log("Error: "+t.data))},error:function(e,t,n){console.log("Error: "+n)}})}))}))}));