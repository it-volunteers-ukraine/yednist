document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("js-open-feedback-form"),t=document.getElementById("js-close-feedback-form"),s=document.getElementById("js-feedback-form"),n=document.querySelector(".feedback-modal");if(e){e.addEventListener("click",(function(){const e=window.scrollY;document.documentElement.style.scrollBehavior="auto",s.classList.remove("is-hidden"),i(m),t.addEventListener("click",a),s.addEventListener("mousedown",d),window.addEventListener("keydown",c),window.addEventListener("resize",o),document.documentElement.classList.add("modal__opened"),document.documentElement.style.top=`-${e}px`}));let m=window.innerHeight;const u=getComputedStyle(n),v=parseInt(u.height);function o(){m=window.innerHeight,i(m)}function i(e){v>e?n.classList.add("horizontal"):n.classList.remove("horizontal")}function a(){s.classList.add("is-hidden"),t.removeEventListener("click",a),s.removeEventListener("mousedown",d),n.classList.remove("horizontal");const e=parseInt(document.documentElement.style.top||"0");document.documentElement.classList.remove("modal__opened"),window.scrollTo(0,-e),document.documentElement.style.scrollBehavior="smooth"}function d(e){e.target===s&&a()}function c(e){"Escape"===e.key&&(e.preventDefault(),a(),window.removeEventListener("keydown",c))}}const l=document.querySelector(".feedback-select-js"),r=document.getElementById("case-js");if(l){const f=new Choices(l,{placeholderValue:"Виберіть програму...",searchEnabled:!1,allowHTML:!1,shouldSort:!1,position:"bottom",itemSelectText:""}),h=document.querySelector(".feedback-modal .choices__inner"),L=f.config.choices.length;f.passedElement.element.addEventListener("choice",(function(e){e.detail.choice.active?(h.classList.add("valid"),h.classList.remove("invalid")):(h.classList.remove("valid"),h.classList.add("invalid")),e.detail.choice.id===L?r.classList.add("shown"):r.classList.remove("shown")}),!1)}e&&jQuery(document).ready((function(e){const t=e(".input-name")[0],s=e(".input-email")[0],n=e(".input-case")[0],o=e(".input-review")[0];function i(t){const s=t.target,n=s.value.trim();let i,a;switch(s.getAttribute("name")){case"title":i=/^[^\d]+$/,a=i.test(n);break;case"email":i=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,a=i.test(n);break;case"case":case"description":a=n.length>=1}if(a?(s.classList.add("valid"),s.classList.remove("invalid")):(s.classList.add("invalid"),s.classList.remove("valid")),s===o){const t=e(".textarea-box");!a||s.classList.contains("invalid")?t.addClass("invalid").removeClass("valid"):t.addClass("valid").removeClass("invalid")}}t.addEventListener("keyup",i),s.addEventListener("keyup",i),n.addEventListener("keyup",i),o.addEventListener("keyup",i),e("#new_post").submit((function(a){a.preventDefault();var d,c=e(this),l=e(".feedback-notification-js"),r=e(".close-notification-btn"),m=function(e){"Escape"===e.key&&(e.preventDefault(),v())},u=function(t){e(t.target).is(l)&&v()};function v(){const t=e("html").css("top");clearTimeout(d),l.addClass("is-hidden"),l.off("mousedown",u),e("html").removeClass("modal__opened"),window.scrollTo(0,-1*parseInt(t||"0")),e(window).off("keydown",m),e("html").css("scrollBehavior","smooth")}const f=[t,s,o];e(".feedback-case")[0].classList.contains("shown")&&f.push(n);let h=!0;f.forEach((t=>{i({target:t}),t.value.trim()&&!t.classList.contains("invalid")||(t.classList.add("invalid"),e(".feedback-alert").removeClass("hidden"),h=!1)}));const L=e(".feedback-modal .choices__inner")[0];e(".feedback-modal .choices__inner .choices__item")[0].classList.contains("choices__placeholder")&&(L.classList.add("invalid"),e(".feedback-alert").removeClass("hidden"),h=!1),h&&e.ajax({type:c.attr("method"),url:c.attr("action"),data:c.serialize(),success:function(t){t.success?(c.trigger("reset"),e(".feedback-alert").addClass("hidden"),e(".feedback-backdrop").addClass("is-hidden"),setTimeout((function(){e(".feedback-backdrop").addClass("is-hidden"),l.removeClass("is-hidden"),e(window).on("keydown",m),l.on("mousedown",u),d=setTimeout(v,5e3),r.on("click",v)}))):(e(".feedback-alert").removeClass("hidden"),console.log("Error: "+t.data))},error:function(e,t,s){console.log("Error: "+s)}})}))}))}));